# 마이크로태스크 큐

```javascript
setTimeout(() => console.log(1), 0);

Promise.resolve()
    .then(() => console.log(2))
    .then(() => console.log(3));
```

위 코드는 1 -> 2 -> 3d의 순서로 출력될 것 처럼 보이지만 2 -> 3 -> - 1의 순서로 출력된다.

정답부터 말하자면 프로미스의 후속 처리 메서드의 콜백 함수는 태스크 큐가 아닌 마이크로태스크 큐에 저장되기 때문이다.

마이크로태스크 큐는 프로미스의 후속 처리 메서드의 콜백 함수가 일시 저장되는 큐고, 태스크 큐에는 그 외 비동기 함수으 콜백 함수나 이벤트 핸들러가 일시 저장되는 큐다.

두 개의 큐 모두 콜백함수나 이벤트 핸들러를 일시 저장하는 것은 동일하지만 우선순위에서 차이점이 있다. 마이크로태스크 큐가 태스크 큐보다 우선순위가 더 높다.

즉 이벤트 루프는 콜 스택이 비면 먼저 마이크로태스크 큐에 대기하는 있는 함수를 먼저 실행하고 이후 태스큐 큐에 대기하고 있는 함수를 실행한다.
